golden:
<extra_id_0>
inference:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;

if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)
if (!dir->tdir_count || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w) goto bad;
if (!tdir->tdir_count ||!w || (tsize_t)tdir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count) goto bad;
if (!dir->tdir_count &&!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)(dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) return;
if (!dir->tdir_count ||!w || ((tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!(dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if(!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w == cc) goto bad;
if (!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w && (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!(tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= 0) goto bad;
if (dir->tdir_count  0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w) goto bad;
if (!dir->tdir_count ||!w ||!(tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count || (!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (size_t)dir->tdir_count / w!= cc) goto bad;
if (!dir.tdir_count ||!w || (tsize_t)dir.tdir_count / w!= cc) goto bad;
else if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (uint32_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!u || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) return 0;
if (dir->tdir_count == 0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count) goto bad;
if ((!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  goto bad;
if (!ndir->tdir_count ||!w || (tsize_t)ndir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!W || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count - w!= cc) goto bad;
if (!tif->tif_count ||!w || (tsize_t)tif->tif_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) break;
if (!file->tdir_count ||!w || (tsize_t)file->tdir_count / w!= cc) goto bad;
if (dir->tdir_count &&!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!tif->tdir_count ||!w || (tsize_t)tif->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w  cc) goto bad;
if (!d->tdir_count ||!w || (tsize_t)d->tdir_count / w!= cc) goto bad;
if (!tdir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if ((tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w > cc) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)
if (!dir->tdir_count ||!w || (uint16_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w ||!(tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!ddir->tdir_count ||!w || (tsize_t)ddir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || w!= cc) goto bad;
if (dir->tdir_count!= 0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!h || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  break;
if (dir->tdir_count ||!w || dir->tdir_count / w!= cc) goto bad;
if (!(dir->tdir_count ||!w || (tsize_t)(dir->tdir_count / w!= cc)) goto bad;
if (!adir->tdir_count ||!w || (tsize_t)adir->tdir_count / w!= cc) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  goto bad;
if (!dir->tdir_count ||!w || (tsize_t)tdir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||! w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w ||(tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (int)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count + w!= cc) goto bad;
if (!dir->tdir_count ||!b || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w >= cc) goto bad;
if (!dir->tdir_count ||!r || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= tc) goto bad;
if (!dir->tdir_count ||!i || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!m || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (dir->tdir_count || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count/w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) dir->tdir_count / w!= cc)
if (!m->tdir_count ||!w || (tsize_t)m->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)w->tdir_count / w!= cc) goto bad;
if (!sc->tdir_count ||!w || (tsize_t)sc->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!n || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) (dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc);
if (!dir->tdir_count ||!w || tsize_t) dir->tdir_count / w!= cc) goto bad;
if (!(tdir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!curdir->tdir_count ||!w || (tsize_t)curdir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!l || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= w) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / (tsize_t)cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)(long)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= (int)cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count  cc) goto bad;
if (!dir->tdir_count ||!cc || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!p || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!d || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w > 0) goto bad;
if (!dir->tdir_count ||!w ||!dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc)
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc) return;
if (!&dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)&dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)(tdir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!x || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!p->tdir_count ||!w || (tsize_t)p->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w ||!isMapped(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count  w) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count == cc) goto bad;
if (!dir->tdir_count ||!v || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count || ((tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (dir->tdir_count ||!w || (tsize_t) dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / sizeof(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= ac) goto bad;
if (!dir->tdir_count ||!0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count * w!= cc) goto bad;
if ((dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!this->tdir_count ||!w || (tsize_t)this->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc ) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / *w!= cc) goto bad;
if (!dir->tdir_count ||!w ||!cc) goto bad;
if (!dir->tdir_count ||!g || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!o || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w) return;
if (dir->tdir_count > 0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count - cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)w / w!= cc) goto bad;
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc)  goto bad;
if (dir->tdir_count  0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!s || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cp) goto bad;
if (!dir->tdir_count ||!z || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) geto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) continue;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w = cc) goto bad;
if (!tdir_count ||!w || (tsize_t)tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!r || (tsize_t)dir->tdir_count / r!= cc) goto bad;
if (!dir->tdir_count ||!W || (tsize_t)dir->tdir_count / w!= cc)
dir->tdir_count |=!w || (tsize_t)dir->tdir_count / w!= cc;
if (!ldir->tdir_count ||!w || (tsize_t)ldir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) return -1;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count > cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / W!= cc) goto bad;
if (!dir->tdir_count ||!w || (t size_t)dir->tdir_count / w!= cc) goto bad;
if (!td->tdir_count ||!w || (tsize_t)td->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)(dir->tdir_count / w)!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count /* w!= cc) goto bad;
if (!dir->tdir_count ||!w || (buf_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || cc!= 0) goto bad;
if (!dir->tdir_count || (size_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!&w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (u_long)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (psize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w + 1!= cc) goto bad;
if (dir->tdir_count ||!w) goto bad;
if (dir->tdir_count  w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count && (!w || (tsize_t)dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!f || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (dir->tdir_count) goto bad;
if (!dir->tdir_count ||!a || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t) dir->tdir_count / w!= cc) return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc - 1) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= acc) goto bad;
if (!dir->tdir_count || dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= -1) goto bad;
if (!dir->tdir_count || w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= lcc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= sc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= tif) goto bad;
if (!dir->tdir_count || (dir->tdir_count / w!= cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= dir->tdir_count) goto bad;
if (!dir->tdir_count ||!w || cc!= cc) goto bad;
if (!isMapped(tif)) goto bad;
tsize_t offset = dir->tdir_offset + cc;
if (!dir->tdir_count || (tsize_t)dir->tdir_count / w!= cc)
if (!W || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w ||!dir->tdir_count) goto bad;
if (!cc) goto bad;
if (!dir->tdir_count ||!w);
if (!dir->tdir_count ||!w || (tsize_t)cc) goto bad;
if (!dir->tdir_count) return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad; #endif
if (!dir->tdir_count ||!w
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad; break;
goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad; */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, cp, cc)) goto bad; _TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset, cc);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* If the user has already detected the item and/or it's a directory or it is a directory, we * may have been given it by a parent and not a parent. */ if ((tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* Get rid of the dir flags */ if (!isMapped(tif))  if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad;  else  if (!ReadOK(tif, dir->tdir_offset)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!isMapped(tif))  if (!SeekOK(tif, dir->tdir_offset)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!WaitIsNone(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ISMapped(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ISMapped(tif))  if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, dir->tdir_offset)) goto bad;  else  if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* Now open the file. */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  TIFF_IF_BYTE(tif, cc, tif->tif_flags, TIFF_IF_LONG, &tif->tif_cflag);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* Only use long long tif */ if (dir->tdir_offset  0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (dir->tdir_count  0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* No such directory name */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, cp, cc)) goto bad;  else  if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  TIFFFetchDataWidth: goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!seekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* The w-per-id &/* the tsize_t */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, dir->tdir_offset)) goto bad; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0;  if (!isMapped(tif))  TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc);  if (!tif->tif_flags & TIFF_SWAB)  switch (dir->tif_type)  case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  TIFFFetchData(); goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t d;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  TIFF_NO_EXT(tif);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if ((tsize_t)dir->tdir_count  cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;  else  if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  if (!SeekOK(tif, dir->tdir_offset)) goto bad;   else  if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (isMapped(tif))  if (!SeekOK(tif, dir->tdir_offset)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;   else  tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset)) goto bad;  else  if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (isMapped(tif))  if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ReadOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!IsEmpty())
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  /* FIXME: XXX - */ goto bad;  if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  tsize_t w;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!IsDirTitle(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)  if (!ISMapped(tif))  if (!SeekOK(tif, dir->tdir_offset)) goto bad;  else  tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(); goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count <cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!WaitIsNone(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* FIXME: XXX - */ goto bad; <if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* FIXME: XXX - */ goto bad; if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* FIXME: XXX - */ goto bad; <if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* The w-per-id &/* the tsize_t */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!IsEmpty())
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (dir->tdir_count &0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* FIXME: XXX - */ goto bad; <if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t w;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= &cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
&if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if ((tsize_t)dir->tdir_count <cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc)
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if ((tsize_t)dir->tdir_count cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* FIXME: XXX - */ goto bad; if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t d;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count &cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if ((tsize_t)dir->tdir_count cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!seekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w &cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Get rid of the dir flags */ if (!isMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!WaitIsNone(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count cc) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchDataWidth: goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Only use long long tif */ if (dir->tdir_offset &0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!IsDirTitle(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (dir->tdir_count &0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Get rid of the dir flags */ if (!isMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w = cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Get rid of the dir flags */ if (!isMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchDataWidth: goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (dir->tdir_count &0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (dir->tdir_count 0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; _TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset, cc);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t d;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w &= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (dir->tdir_count <0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFF_IF_BYTE(tif, cc, tif->tif_flags, TIFF_IF_LONG, &tif->tif_cflag);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count &w) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t) dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Only use long long tif */ if (dir->tdir_offset <0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Get rid of the dir flags */ if (!isMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* No such directory name */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count 0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Get rid of the dir flags */ if (!isMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(); goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t d;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (dir->tdir_count 0) goto bad; goto bad;
if (dir->tdir_count <0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
<if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* FIXME: XXX - */ goto bad; &if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!IsEmpty())
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!IsDirTitle(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!seekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &break;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count 0 ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* If the user has already detected the item and/or it's a directory or it is a directory, we * may have been given it by a parent and not a parent. */ if ((tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Only use long long tif */ if (dir->tdir_offset 0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Only use long long tif */ if (dir->tdir_offset <0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; _TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset, cc);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc) &goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Only use long long tif */ if (dir->tdir_offset &0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!IsDirTitle(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if ((tsize_t)dir->tdir_count &cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Get rid of the dir flags */ if (!isMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if ((tsize_t)dir->tdir_count cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <return;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count <w) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t w;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w <= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <break;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Only use long long tif */ if (dir->tdir_offset 0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* If the user has already detected the item and/or it's a directory or it is a directory, we * may have been given it by a parent and not a parent. */ if ((tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count <0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count w) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if ((tsize_t)dir->tdir_count &cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Get rid of the dir flags */ if (!isMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* FIXME: XXX - */ goto bad; &if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFF_NO_EXT(tif);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= <cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Now open the file. */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* FIXME: XXX - */ goto bad; if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Now open the file. */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t w;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Only use long long tif */ if (dir->tdir_offset <0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* Get rid of the dir flags */ if (!isMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (dir->tdir_count <0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if ((tsize_t)dir->tdir_count <cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* The w-per-id &/* the tsize_t */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (dir->tdir_count &0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchDataWidth: goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* If the user has already detected the item and/or it's a directory or it is a directory, we * may have been given it by a parent and not a parent. */ if ((tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count <w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) break;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w <cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Get rid of the dir flags */ if (!isMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if ((tsize_t)dir->tdir_count &cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFF_IF_BYTE(tif, cc, tif->tif_flags, TIFF_IF_LONG, &tif->tif_cflag);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) /* FIXME: XXX - */ goto bad; &if (!(tsize_t)(dir->tdir_count) || (tsize_t)(dir->tdir_count) / w!= cc)) goto bad; if (!(tsize_t)(dir->tdir_count) / w!= cc) goto bad; /* FIXME: FIXME: XXX - */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* No such directory name */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Now open the file. */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if ((tsize_t)dir->tdir_count <cc) goto bad; /* Unuse the flags in this */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (dir->tdir_count &0 || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFF_NO_EXT(tif);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!seekOK(tif, dir->tdir_offset + cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (dir->tdir_count &w || (tsize_t)dir->tdir_count / w!= cc) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!IsEmpty())
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!WaitIsNone(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* Only use long long tif */ if (dir->tdir_offset 0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFF_IF_BYTE(tif, cc, tif->tif_flags, TIFF_IF_LONG, &tif->tif_cflag);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &/* The w-per-id &/* the tsize_t */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* No such directory name */ goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (dir->tdir_count <0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; _TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset, cc);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFF_NO_EXT(tif);
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else &if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; <else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (dir->tdir_count 0) goto bad; goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(); goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; &if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, dir->tdir_offset)) goto bad; else &if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) </* Only use long long tif */ if (dir->tdir_offset &0) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad; <else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, cp, cc)) goto bad; &else &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) &if (!ReadOK(tif, cp, cc)) goto bad; &else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; if (!isMapped(tif)) &TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else <if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) goto bad; tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) goto bad; if (!ReadOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; if (!ReadOK(t
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!isMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. *
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; else <if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, dir->tdir_offset)) goto bad; else if (!
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || dir->tdir_count / w!= cc) <goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); return 0; <if (!isMapped(tif)) TIFFFetchData(TIFF_DIR_IDLE, tif, dir->tdir_type); tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else TIFFmemcpy(cp, tif->tif_base + dir->tdir_offset + cc); if (!tif->tif_flags & TIFF_SWAB) switch (dir->tif_type) case TIFF_SHORT: case TIFF_SSHORT:
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; &else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; &else if (!SeekOK(tif, dir->tdir_offset + cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset +
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (isMapped(tif)) &if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else if (!SeekOK(tif, cp, cc)) goto bad; if (!ReadOK(tif, cp, cc)) goto bad; else tsize
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ReadOK(tif, cp, cc)) goto bad; else <tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ISMapped(tif)) <if (!SeekOK(tif, dir->tdir_offset)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) tsize_t offset = dir->tdir_offset + cc; if (!ReadOK(tif, cp, cc)) goto bad; <else &tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) &if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) <if (!ReadOK(tif, dir->tdir_offset + cc)) goto bad; <else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad; else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!ISMapped(tif)) if (!ReadOK(tif, cp, cc)) goto bad; &else tsize_t offset = dir->tdir_offset + cc; /* Check for overflow. */ if (!ReadOK(tif, cp, cc)) goto bad;
if (!dir->tdir_count ||!w || (tsize_t)dir->tdir_count / w!= cc) if (!SeekOK(tif, dir->tdir_offset)) goto bad; &else <if (!ReadOK(tif, cp, cc)) goto bad;
